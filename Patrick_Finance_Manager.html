<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#0a0a1a">
<title>Patrick's â€“ Finance Manager</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&family=Syne:wght@400;600;700;800&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
<style>
  :root {
    --bg:        #0a0a1a;
    --surface:   #111128;
    --card:      #161630;
    --border:    #1e1e42;
    --emerald:   #00d4a0;
    --emerald2:  #00a87e;
    --gold:      #ffd166;
    --red:       #ff5c7c;
    --blue:      #4facfe;
    --text:      #e8e8f5;
    --muted:     #6b6b9a;
    --white:     #ffffff;
    --radius:    16px;
    --radius-sm: 10px;
  }

  * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }

  body {
    font-family: 'Syne', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* â”€â”€ NOISE TEXTURE OVERLAY â”€â”€ */
  body::before {
    content:'';
    position:fixed; inset:0;
    background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.04'/%3E%3C/svg%3E");
    pointer-events:none; z-index:0; opacity:0.4;
  }

  /* â”€â”€ TOP HEADER â”€â”€ */
  .app-header {
    position: sticky; top:0; z-index:100;
    background: rgba(10,10,26,0.92);
    backdrop-filter: blur(20px);
    border-bottom: 1px solid var(--border);
    padding: 14px 20px;
    display: flex; align-items:center; justify-content:space-between;
  }
  .app-header .logo {
    display:flex; align-items:center; gap:10px;
  }
  .app-header .logo-icon {
    width:36px; height:36px; border-radius:10px;
    background: linear-gradient(135deg, var(--emerald), var(--blue));
    display:flex; align-items:center; justify-content:center;
    font-size:18px;
  }
  .app-header .logo-text {
    font-family:'Space Mono',monospace;
    font-size:13px; font-weight:700;
    color: var(--emerald);
    letter-spacing:1px;
  }
  .app-header .logo-sub {
    font-size:10px; color:var(--muted); letter-spacing:2px;
    text-transform:uppercase;
  }
  .header-date {
    text-align:right;
    font-family:'Space Mono',monospace;
    font-size:11px; color:var(--muted);
    line-height:1.6;
  }

  /* â”€â”€ MAIN CONTENT â”€â”€ */
  .app-body { padding: 0 0 100px 0; position:relative; z-index:1; }

  /* â”€â”€ TAB PAGES â”€â”€ */
  .page { display:none; animation: fadeUp 0.3s ease; }
  .page.active { display:block; }
  @keyframes fadeUp {
    from { opacity:0; transform:translateY(12px); }
    to   { opacity:1; transform:translateY(0); }
  }

  /* â”€â”€ GREETING BANNER â”€â”€ */
  .greeting-banner {
    margin: 20px 16px 0;
    padding: 18px 20px;
    border-radius: var(--radius);
    background: linear-gradient(135deg, #0d1f3c 0%, #0a1a2e 100%);
    border: 1px solid rgba(0,212,160,0.15);
    position:relative; overflow:hidden;
  }
  .greeting-banner::before {
    content:'';
    position:absolute; top:-40px; right:-40px;
    width:120px; height:120px; border-radius:50%;
    background: radial-gradient(circle, rgba(0,212,160,0.15), transparent 70%);
  }
  .greeting-time { font-size:11px; color:var(--muted); letter-spacing:2px; text-transform:uppercase; margin-bottom:4px; }
  .greeting-text { font-size:18px; font-weight:800; color:var(--white); line-height:1.3; }
  .greeting-sub  { font-size:12px; color:var(--emerald); margin-top:4px; font-family:'Space Mono',monospace; }

  /* â”€â”€ KPI GRID â”€â”€ */
  .kpi-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    padding: 16px;
  }
  .kpi-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 16px;
    position:relative; overflow:hidden;
    transition: transform 0.2s ease, border-color 0.2s ease;
  }
  .kpi-card:active { transform: scale(0.97); }
  .kpi-card::after {
    content:'';
    position:absolute; bottom:0; left:0; right:0; height:2px;
    background: var(--accent-color, var(--emerald));
    border-radius:0 0 var(--radius) var(--radius);
  }
  .kpi-icon  { font-size:20px; margin-bottom:8px; display:block; }
  .kpi-label { font-size:10px; color:var(--muted); text-transform:uppercase; letter-spacing:1.5px; margin-bottom:4px; }
  .kpi-value { font-family:'Space Mono',monospace; font-size:16px; font-weight:700; color:var(--white); }
  .kpi-value.emerald { color:var(--emerald); }
  .kpi-value.red     { color:var(--red); }
  .kpi-value.gold    { color:var(--gold); }
  .kpi-value.blue    { color:var(--blue); }
  .kpi-card.wide {
    grid-column: span 2;
    display:flex; align-items:center; justify-content:space-between;
  }
  .kpi-card.wide .kpi-right { text-align:right; }

  /* â”€â”€ SECTION HEADERS â”€â”€ */
  .section-header {
    display:flex; align-items:center; justify-content:space-between;
    padding: 8px 16px 4px;
  }
  .section-title {
    font-size:11px; font-weight:700; color:var(--muted);
    text-transform:uppercase; letter-spacing:2px;
  }

  /* â”€â”€ FILTER BAR â”€â”€ */
  .filter-bar {
    display:flex; gap:8px; padding:0 16px 12px;
    overflow-x:auto; scrollbar-width:none;
  }
  .filter-bar::-webkit-scrollbar { display:none; }
  .filter-chip {
    flex-shrink:0;
    padding:6px 14px; border-radius:20px;
    border: 1px solid var(--border);
    background: var(--surface);
    color: var(--muted); font-size:12px; font-weight:600;
    cursor:pointer; transition: all 0.2s ease;
    font-family:'Syne',sans-serif;
  }
  .filter-chip.active {
    background: var(--emerald); color: var(--bg);
    border-color: var(--emerald);
  }

  /* â”€â”€ CHART CARDS â”€â”€ */
  .chart-card {
    margin: 0 16px 16px;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 16px;
  }
  .chart-title {
    font-size:12px; font-weight:700; color:var(--text);
    margin-bottom:14px; text-transform:uppercase; letter-spacing:1px;
  }
  .chart-container { position:relative; height:180px; }

  /* â”€â”€ ACTION BUTTONS â”€â”€ */
  .action-grid {
    display:grid; grid-template-columns:1fr 1fr 1fr;
    gap:10px; padding:0 16px 16px;
  }
  .action-btn {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 16px 8px;
    display:flex; flex-direction:column;
    align-items:center; gap:8px;
    cursor:pointer; transition: all 0.2s ease;
    text-decoration:none;
  }
  .action-btn:active { transform:scale(0.95); background:var(--surface); }
  .action-btn .btn-icon { font-size:24px; }
  .action-btn .btn-label { font-size:10px; color:var(--muted); text-align:center; font-weight:700; letter-spacing:0.5px; text-transform:uppercase; }
  .action-btn.primary { border-color:var(--emerald); background:rgba(0,212,160,0.05); }
  .action-btn.primary .btn-label { color:var(--emerald); }

  /* â”€â”€ MODAL / FORM OVERLAY â”€â”€ */
  .modal-overlay {
    display:none; position:fixed; inset:0; z-index:200;
    background: rgba(0,0,0,0.7);
    backdrop-filter:blur(6px);
    align-items:flex-end; justify-content:center;
  }
  .modal-overlay.open { display:flex; }
  .modal-sheet {
    width:100%; max-width:500px;
    background: var(--surface);
    border-radius: 24px 24px 0 0;
    border-top: 1px solid var(--border);
    padding: 0 0 40px;
    animation: slideUp 0.35s cubic-bezier(0.34,1.56,0.64,1);
    max-height: 92vh; overflow-y:auto;
  }
  @keyframes slideUp {
    from { transform:translateY(100%); }
    to   { transform:translateY(0); }
  }
  .modal-handle {
    width:40px; height:4px;
    background:var(--border); border-radius:2px;
    margin: 14px auto 0;
  }
  .modal-header {
    padding: 20px 20px 0;
    display:flex; align-items:center; justify-content:space-between;
  }
  .modal-title { font-size:20px; font-weight:800; color:var(--white); }
  .modal-sub   { font-size:12px; color:var(--muted); margin-top:3px; }
  .modal-close {
    width:32px; height:32px; border-radius:50%;
    background:var(--card); border:none;
    color:var(--muted); font-size:18px; cursor:pointer;
    display:flex; align-items:center; justify-content:center;
  }

  /* â”€â”€ FORM FIELDS â”€â”€ */
  .form-body { padding: 20px; display:flex; flex-direction:column; gap:16px; }
  .form-group { display:flex; flex-direction:column; gap:6px; }
  .form-label { font-size:11px; font-weight:700; color:var(--muted); text-transform:uppercase; letter-spacing:1.5px; }
  .form-input, .form-select {
    background: var(--card);
    border: 1.5px solid var(--border);
    border-radius: var(--radius-sm);
    padding: 14px 16px;
    color: var(--text);
    font-size:16px;
    font-family:'Syne',sans-serif;
    outline:none;
    transition: border-color 0.2s ease;
    width:100%;
    -webkit-appearance:none;
  }
  .form-input:focus, .form-select:focus {
    border-color: var(--emerald);
    box-shadow: 0 0 0 3px rgba(0,212,160,0.1);
  }
  .form-select { background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%236b6b9a' stroke-width='1.5' fill='none'/%3E%3C/svg%3E"); background-repeat:no-repeat; background-position:right 16px center; padding-right:40px; }
  .form-input::placeholder { color:var(--muted); }
  .amount-input-wrap { position:relative; }
  .amount-input-wrap .currency-prefix {
    position:absolute; left:16px; top:50%; transform:translateY(-50%);
    font-family:'Space Mono',monospace; font-size:16px; color:var(--emerald); font-weight:700;
  }
  .amount-input-wrap .form-input { padding-left:40px; }

  /* â”€â”€ FORM BUTTONS â”€â”€ */
  .form-actions { display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; padding:0 20px; }
  .btn {
    padding:14px; border-radius:var(--radius-sm);
    border:none; font-size:14px; font-weight:700;
    font-family:'Syne',sans-serif; cursor:pointer;
    transition: all 0.2s ease; letter-spacing:0.5px;
  }
  .btn:active { transform:scale(0.97); }
  .btn-submit  { background:var(--emerald); color:var(--bg); }
  .btn-reset   { background:rgba(255,92,124,0.15); color:var(--red); border:1.5px solid var(--red); }
  .btn-cancel  { background:var(--card); color:var(--muted); border:1.5px solid var(--border); }

  /* â”€â”€ LOG LIST â”€â”€ */
  .log-list { padding:0 16px; display:flex; flex-direction:column; gap:10px; }
  .log-item {
    background:var(--card); border:1px solid var(--border);
    border-radius:var(--radius); padding:14px 16px;
    display:flex; align-items:center; justify-content:space-between;
    animation:fadeUp 0.2s ease;
  }
  .log-item-left { display:flex; align-items:center; gap:12px; }
  .log-item-icon {
    width:40px; height:40px; border-radius:10px;
    display:flex; align-items:center; justify-content:center; font-size:18px;
    flex-shrink:0;
  }
  .log-item-title  { font-size:14px; font-weight:700; color:var(--white); }
  .log-item-sub    { font-size:11px; color:var(--muted); margin-top:2px; font-family:'Space Mono',monospace; }
  .log-item-amount { font-family:'Space Mono',monospace; font-size:15px; font-weight:700; text-align:right; }
  .log-item-date   { font-size:10px; color:var(--muted); margin-top:2px; text-align:right; }
  .log-item-status {
    font-size:9px; font-weight:700; padding:3px 8px; border-radius:20px;
    text-transform:uppercase; letter-spacing:1px; margin-top:3px; display:inline-block;
  }
  .status-ok  { background:rgba(0,212,160,0.15); color:var(--emerald); }
  .status-bad { background:rgba(255,92,124,0.15); color:var(--red); }

  /* â”€â”€ EMPTY STATE â”€â”€ */
  .empty-state {
    text-align:center; padding:50px 30px;
    color:var(--muted);
  }
  .empty-state .empty-icon { font-size:48px; margin-bottom:12px; opacity:0.5; }
  .empty-state p { font-size:14px; line-height:1.6; }

  /* â”€â”€ BUDGET BARS â”€â”€ */
  .budget-item {
    background:var(--card); border:1px solid var(--border);
    border-radius:var(--radius); padding:14px 16px; margin-bottom:10px;
  }
  .budget-top { display:flex; justify-content:space-between; align-items:center; margin-bottom:10px; }
  .budget-cat { font-size:13px; font-weight:700; color:var(--white); }
  .budget-amounts { font-family:'Space Mono',monospace; font-size:11px; color:var(--muted); }
  .budget-bar-track { height:6px; background:var(--border); border-radius:3px; overflow:hidden; }
  .budget-bar-fill  { height:100%; border-radius:3px; transition:width 0.6s ease; }
  .budget-bar-fill.ok  { background:linear-gradient(90deg, var(--emerald), var(--blue)); }
  .budget-bar-fill.bad { background:linear-gradient(90deg, var(--gold), var(--red)); }
  .budget-bottom { display:flex; justify-content:space-between; margin-top:6px; }
  .budget-pct { font-family:'Space Mono',monospace; font-size:10px; }

  /* â”€â”€ BOTTOM NAV â”€â”€ */
  .bottom-nav {
    position:fixed; bottom:0; left:0; right:0; z-index:100;
    background:rgba(10,10,26,0.95);
    backdrop-filter:blur(20px);
    border-top:1px solid var(--border);
    display:flex; padding:8px 0 20px;
    safe-area-inset-bottom:20px;
  }
  .nav-item {
    flex:1; display:flex; flex-direction:column;
    align-items:center; gap:4px;
    padding:8px 4px; cursor:pointer;
    transition:all 0.2s ease; border:none;
    background:transparent; color:var(--muted);
    font-family:'Syne',sans-serif;
  }
  .nav-item .nav-icon { font-size:22px; transition:transform 0.2s ease; }
  .nav-item .nav-label { font-size:9px; font-weight:700; text-transform:uppercase; letter-spacing:1px; }
  .nav-item.active { color:var(--emerald); }
  .nav-item.active .nav-icon { transform:scale(1.15); }

  /* â”€â”€ SAVINGS PLATFORM CHIPS â”€â”€ */
  .platform-grid {
    display:grid; grid-template-columns:1fr 1fr;
    gap:8px; padding:0 20px;
  }
  .platform-chip {
    padding:12px 16px; border-radius:var(--radius-sm);
    border:1.5px solid var(--border); background:var(--card);
    color:var(--muted); font-size:13px; font-weight:600;
    cursor:pointer; text-align:center; transition:all 0.2s ease;
  }
  .platform-chip.selected { border-color:var(--emerald); color:var(--emerald); background:rgba(0,212,160,0.08); }

  /* â”€â”€ TOAST â”€â”€ */
  .toast {
    position:fixed; top:80px; left:50%; transform:translateX(-50%) translateY(-20px);
    background:var(--emerald); color:var(--bg);
    padding:12px 24px; border-radius:30px;
    font-size:13px; font-weight:700;
    z-index:300; opacity:0;
    transition:all 0.3s cubic-bezier(0.34,1.56,0.64,1);
    white-space:nowrap; pointer-events:none;
  }
  .toast.show { opacity:1; transform:translateX(-50%) translateY(0); }
  .toast.error { background:var(--red); }

  /* â”€â”€ HEALTH SCORE RING â”€â”€ */
  .health-ring-wrap { display:flex; justify-content:center; padding:20px 0 10px; }
  .health-ring { position:relative; width:130px; height:130px; }
  .health-ring svg { transform:rotate(-90deg); }
  .health-ring-text {
    position:absolute; inset:0;
    display:flex; flex-direction:column; align-items:center; justify-content:center;
  }
  .health-score { font-family:'Space Mono',monospace; font-size:30px; font-weight:700; color:var(--white); }
  .health-label { font-size:10px; color:var(--muted); text-transform:uppercase; letter-spacing:1px; }

  /* â”€â”€ FORECAST TABLE â”€â”€ */
  .forecast-table { margin:0 16px; overflow:hidden; border-radius:var(--radius); border:1px solid var(--border); }
  .forecast-row {
    display:grid; grid-template-columns:2fr 2fr 2fr 1.5fr;
    gap:0; border-bottom:1px solid var(--border);
  }
  .forecast-row:last-child { border-bottom:none; }
  .forecast-row.header { background:var(--surface); }
  .forecast-cell {
    padding:12px 10px; font-size:11px;
    font-family:'Space Mono',monospace;
    color:var(--muted);
  }
  .forecast-row.header .forecast-cell { font-weight:700; font-size:10px; text-transform:uppercase; letter-spacing:1px; }
  .forecast-cell.month { color:var(--text); font-family:'Syne',sans-serif; font-weight:600; }
  .forecast-cell.income-c { color:var(--emerald); }
  .forecast-cell.expense-c { color:var(--red); }
  .forecast-cell.net-c { color:var(--gold); }
</style>
</head>
<body>

<div class="toast" id="toast"></div>

<!-- â”€â”€ CUSTOM CONFIRM DIALOG â”€â”€ -->
<div id="confirmOverlay" style="display:none;position:fixed;inset:0;z-index:500;background:rgba(0,0,0,0.75);backdrop-filter:blur(6px);align-items:center;justify-content:center;">
  <div style="background:#161630;border:1px solid #1e1e42;border-radius:20px;padding:28px 24px;margin:20px;max-width:320px;width:100%;text-align:center;animation:fadeUp 0.25s ease;">
    <div style="font-size:36px;margin-bottom:12px" id="confirmIcon">ğŸ—‘ï¸</div>
    <div style="font-size:18px;font-weight:800;color:#fff;margin-bottom:8px" id="confirmTitle">Delete Entry?</div>
    <div style="font-size:13px;color:#6b6b9a;margin-bottom:24px;line-height:1.5" id="confirmMsg">This action cannot be undone.</div>
    <div style="display:flex;gap:12px;">
      <button onclick="handleConfirmNo()" style="flex:1;padding:14px;border-radius:12px;border:1.5px solid #1e1e42;background:#111128;color:#6b6b9a;font-size:14px;font-weight:700;font-family:'Syne',sans-serif;cursor:pointer;">Cancel</button>
      <button onclick="handleConfirmYes()" style="flex:1;padding:14px;border-radius:12px;border:none;background:#ff5c7c;color:#fff;font-size:14px;font-weight:700;font-family:'Syne',sans-serif;cursor:pointer;" id="confirmYesBtn">Delete</button>
    </div>
  </div>
</div>

<!-- â”€â”€ APP HEADER â”€â”€ -->
<header class="app-header">
  <div class="logo">
    <div class="logo-icon">ğŸ¦</div>
    <div>
      <div class="logo-text">PATRICK'S</div>
      <div class="logo-sub">Finance Manager</div>
    </div>
  </div>
  <div class="header-date" id="headerDate"></div>
</header>

<!-- â”€â”€ APP BODY â”€â”€ -->
<main class="app-body">

  <!-- â•â•â•â• DASHBOARD PAGE â•â•â•â• -->
  <div class="page active" id="page-dashboard">

    <div class="greeting-banner">
      <div class="greeting-time" id="greetingTime"></div>
      <div class="greeting-text" id="greetingText"></div>
      <div class="greeting-sub" id="greetingSub"></div>
    </div>

    <!-- Filter chips -->
    <div style="height:16px"></div>
    <div class="section-header">
      <span class="section-title">Period</span>
    </div>
    <div class="filter-bar" id="monthFilter">
      <div class="filter-chip active" data-month="All">All</div>
      <div class="filter-chip" data-month="1">Jan</div>
      <div class="filter-chip" data-month="2">Feb</div>
      <div class="filter-chip" data-month="3">Mar</div>
      <div class="filter-chip" data-month="4">Apr</div>
      <div class="filter-chip" data-month="5">May</div>
      <div class="filter-chip" data-month="6">Jun</div>
      <div class="filter-chip" data-month="7">Jul</div>
      <div class="filter-chip" data-month="8">Aug</div>
      <div class="filter-chip" data-month="9">Sep</div>
      <div class="filter-chip" data-month="10">Oct</div>
      <div class="filter-chip" data-month="11">Nov</div>
      <div class="filter-chip" data-month="12">Dec</div>
    </div>

    <!-- KPI Cards -->
    <div class="kpi-grid">
      <div class="kpi-card" style="--accent-color:var(--emerald)">
        <span class="kpi-icon">ğŸ’µ</span>
        <div class="kpi-label">Total Income</div>
        <div class="kpi-value emerald" id="kpiIncome">â‚µ0.00</div>
      </div>
      <div class="kpi-card" style="--accent-color:var(--red)">
        <span class="kpi-icon">ğŸ’¸</span>
        <div class="kpi-label">Total Expenses</div>
        <div class="kpi-value red" id="kpiExpenses">â‚µ0.00</div>
      </div>
      <div class="kpi-card" style="--accent-color:var(--gold)">
        <span class="kpi-icon">ğŸ’°</span>
        <div class="kpi-label">Net Savings</div>
        <div class="kpi-value gold" id="kpiSavings">â‚µ0.00</div>
      </div>
      <div class="kpi-card" style="--accent-color:var(--blue)">
        <span class="kpi-icon">ğŸ“Š</span>
        <div class="kpi-label">Savings Rate</div>
        <div class="kpi-value blue" id="kpiRate">0.0%</div>
      </div>
      <div class="kpi-card wide" style="--accent-color:var(--emerald)">
        <div>
          <span class="kpi-icon">ğŸ›¡ï¸</span>
          <div class="kpi-label">Emergency Fund</div>
          <div class="kpi-value emerald" id="kpiEF">â‚µ0.00</div>
        </div>
        <div class="kpi-right">
          <div class="kpi-label">Target</div>
          <div class="kpi-value" style="color:var(--muted)" id="kpiEFTarget">â‚µ10,000.00</div>
          <div class="kpi-label" style="margin-top:4px">Progress</div>
          <div class="kpi-value gold" id="kpiEFPct">0%</div>
        </div>
      </div>
    </div>

    <!-- Health Score -->
    <div class="section-header"><span class="section-title">Financial Health</span></div>
    <div class="health-ring-wrap">
      <div class="health-ring">
        <svg width="130" height="130" viewBox="0 0 130 130">
          <circle cx="65" cy="65" r="55" fill="none" stroke="#1e1e42" stroke-width="10"/>
          <circle cx="65" cy="65" r="55" fill="none" stroke="url(#healthGrad)" stroke-width="10"
            stroke-linecap="round" stroke-dasharray="345.4" id="healthArc"
            stroke-dashoffset="345.4"/>
          <defs>
            <linearGradient id="healthGrad" x1="0%" y1="0%" x2="100%" y2="0%">
              <stop offset="0%" stop-color="#00d4a0"/>
              <stop offset="100%" stop-color="#4facfe"/>
            </linearGradient>
          </defs>
        </svg>
        <div class="health-ring-text">
          <div class="health-score" id="healthScore">0</div>
          <div class="health-label">/ 100</div>
        </div>
      </div>
    </div>

    <!-- Chart -->
    <div class="section-header"><span class="section-title">Monthly Overview</span></div>
    <div class="chart-card">
      <div class="chart-title">Income vs Expenses</div>
      <div class="chart-container">
        <canvas id="monthlyChart"></canvas>
      </div>
    </div>

    <!-- Quick actions -->
    <div class="section-header"><span class="section-title">Quick Entry</span></div>
    <div class="action-grid">
      <div class="action-btn primary" onclick="openModal('income')">
        <span class="btn-icon">ğŸ’µ</span>
        <span class="btn-label">Add Income</span>
      </div>
      <div class="action-btn primary" onclick="openModal('expense')">
        <span class="btn-icon">ğŸ’¸</span>
        <span class="btn-label">Add Expense</span>
      </div>
      <div class="action-btn primary" onclick="openModal('savings')">
        <span class="btn-icon">ğŸ’°</span>
        <span class="btn-label">Add Savings</span>
      </div>
    </div>

  </div><!-- end dashboard -->

  <!-- â•â•â•â• INCOME PAGE â•â•â•â• -->
  <div class="page" id="page-income">
    <div style="padding:20px 16px 8px">
      <div style="font-size:22px;font-weight:800;color:var(--white)">Income Log</div>
      <div style="font-size:12px;color:var(--muted);margin-top:2px">All your income entries</div>
    </div>
    <div style="padding:0 16px 12px;display:flex;justify-content:flex-end">
      <div class="action-btn primary" style="width:auto;flex-direction:row;gap:8px;padding:10px 16px" onclick="openModal('income')">
        <span>â•</span><span class="btn-label" style="font-size:11px">Add Income</span>
      </div>
    </div>
    <div class="log-list" id="incomeList">
      <div class="empty-state">
        <div class="empty-icon">ğŸ’µ</div>
        <p>No income entries yet.<br>Tap Add Income to get started.</p>
      </div>
    </div>
  </div>

  <!-- â•â•â•â• EXPENSE PAGE â•â•â•â• -->
  <div class="page" id="page-expense">
    <div style="padding:20px 16px 8px">
      <div style="font-size:22px;font-weight:800;color:var(--white)">Expense Log</div>
      <div style="font-size:12px;color:var(--muted);margin-top:2px">All your expense entries</div>
    </div>
    <div style="padding:0 16px 12px;display:flex;justify-content:flex-end">
      <div class="action-btn primary" style="width:auto;flex-direction:row;gap:8px;padding:10px 16px" onclick="openModal('expense')">
        <span>â•</span><span class="btn-label" style="font-size:11px">Add Expense</span>
      </div>
    </div>
    <!-- Category pie chart -->
    <div class="chart-card">
      <div class="chart-title">Spending by Category</div>
      <div class="chart-container">
        <canvas id="categoryChart"></canvas>
      </div>
    </div>
    <div class="log-list" id="expenseList">
      <div class="empty-state">
        <div class="empty-icon">ğŸ’¸</div>
        <p>No expenses yet.<br>Tap Add Expense to get started.</p>
      </div>
    </div>
  </div>

  <!-- â•â•â•â• SAVINGS PAGE â•â•â•â• -->
  <div class="page" id="page-savings">
    <div style="padding:20px 16px 8px">
      <div style="font-size:22px;font-weight:800;color:var(--white)">Savings Log</div>
      <div style="font-size:12px;color:var(--muted);margin-top:2px">Track savings across platforms</div>
    </div>
    <div style="padding:0 16px 12px;display:flex;justify-content:space-between;align-items:center">
      <div style="font-family:'Space Mono',monospace;font-size:18px;font-weight:700;color:var(--emerald)" id="totalSavingsDisplay">â‚µ0.00</div>
      <div class="action-btn primary" style="width:auto;flex-direction:row;gap:8px;padding:10px 16px" onclick="openModal('savings')">
        <span>â•</span><span class="btn-label" style="font-size:11px">Add Savings</span>
      </div>
    </div>
    <!-- Savings breakdown chart -->
    <div class="chart-card">
      <div class="chart-title">Savings by Platform</div>
      <div class="chart-container">
        <canvas id="savingsChart"></canvas>
      </div>
    </div>
    <div class="log-list" id="savingsList">
      <div class="empty-state">
        <div class="empty-icon">ğŸ’°</div>
        <p>No savings logged yet.<br>Tap Add Savings to get started.</p>
      </div>
    </div>
  </div>

  <!-- â•â•â•â• BUDGET PAGE â•â•â•â• -->
  <div class="page" id="page-budget">
    <div style="padding:20px 16px 8px">
      <div style="font-size:22px;font-weight:800;color:var(--white)">Budget Manager</div>
      <div style="font-size:12px;color:var(--muted);margin-top:2px">Set and track your spending limits</div>
    </div>
    <div style="padding:0 16px 16px" id="budgetList"></div>
  </div>

</main>

<!-- â”€â”€ BOTTOM NAVIGATION â”€â”€ -->
<nav class="bottom-nav">
  <button class="nav-item active" onclick="switchPage('dashboard',this)">
    <span class="nav-icon">ğŸ </span>
    <span class="nav-label">Home</span>
  </button>
  <button class="nav-item" onclick="switchPage('income',this)">
    <span class="nav-icon">ğŸ’µ</span>
    <span class="nav-label">Income</span>
  </button>
  <button class="nav-item" onclick="switchPage('expense',this)">
    <span class="nav-icon">ğŸ’¸</span>
    <span class="nav-label">Expenses</span>
  </button>
  <button class="nav-item" onclick="switchPage('savings',this)">
    <span class="nav-icon">ğŸ’°</span>
    <span class="nav-label">Savings</span>
  </button>
  <button class="nav-item" onclick="switchPage('budget',this)">
    <span class="nav-icon">ğŸ“‹</span>
    <span class="nav-label">Budget</span>
  </button>
</nav>

<!-- â•â•â•â• INCOME MODAL â•â•â•â• -->
<div class="modal-overlay" id="modal-income">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-header">
      <div>
        <div class="modal-title">Add Income ğŸ’µ</div>
        <div class="modal-sub">Record a new income entry</div>
      </div>
      <button class="modal-close" onclick="closeModal('income')">âœ•</button>
    </div>
    <div class="form-body">
      <div class="form-group">
        <label class="form-label">Amount (GHS)</label>
        <div class="amount-input-wrap">
          <span class="currency-prefix">â‚µ</span>
          <input class="form-input" type="number" id="inc-amount" placeholder="0.00" min="0" step="0.01" inputmode="decimal">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Income Type</label>
        <select class="form-select" id="inc-type">
          <option>Salary</option>
          <option>Tips</option>
          <option>Gift</option>
          <option>Business</option>
          <option>Other</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">Description</label>
        <input class="form-input" type="text" id="inc-desc" placeholder="e.g. Monthly salary">
      </div>
      <div class="form-group">
        <label class="form-label">Date</label>
        <input class="form-input" type="date" id="inc-date">
      </div>
    </div>
    <div class="form-actions">
      <button class="btn btn-submit" onclick="submitIncome()">Submit</button>
      <button class="btn btn-reset"  onclick="resetForm('income')">Reset</button>
      <button class="btn btn-cancel" onclick="closeModal('income')">Cancel</button>
    </div>
  </div>
</div>

<!-- â•â•â•â• EXPENSE MODAL â•â•â•â• -->
<div class="modal-overlay" id="modal-expense">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-header">
      <div>
        <div class="modal-title">Add Expense ğŸ’¸</div>
        <div class="modal-sub">Track your spending</div>
      </div>
      <button class="modal-close" onclick="closeModal('expense')">âœ•</button>
    </div>
    <div class="form-body">
      <div class="form-group">
        <label class="form-label">Amount (GHS)</label>
        <div class="amount-input-wrap">
          <span class="currency-prefix">â‚µ</span>
          <input class="form-input" type="number" id="exp-amount" placeholder="0.00" min="0" step="0.01" inputmode="decimal">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Category</label>
        <select class="form-select" id="exp-cat">
          <option>Food</option>
          <option>Electricity</option>
          <option>Water</option>
          <option>Rent</option>
          <option>Health</option>
          <option>Transport</option>
          <option>Data</option>
          <option>Clothing</option>
          <option>Education</option>
          <option>Entertainment</option>
          <option>Family & Social Support</option>
          <option>Savings/Maintenance</option>
          <option>Other</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">Description</label>
        <input class="form-input" type="text" id="exp-desc" placeholder="e.g. Weekly groceries">
      </div>
      <div class="form-group">
        <label class="form-label">Date</label>
        <input class="form-input" type="date" id="exp-date">
      </div>
    </div>
    <div class="form-actions">
      <button class="btn btn-submit" onclick="submitExpense()">Submit</button>
      <button class="btn btn-reset"  onclick="resetForm('expense')">Reset</button>
      <button class="btn btn-cancel" onclick="closeModal('expense')">Cancel</button>
    </div>
  </div>
</div>

<!-- â•â•â•â• SAVINGS MODAL â•â•â•â• -->
<div class="modal-overlay" id="modal-savings">
  <div class="modal-sheet">
    <div class="modal-handle"></div>
    <div class="modal-header">
      <div>
        <div class="modal-title">Add Savings ğŸ’°</div>
        <div class="modal-sub">Log your savings across platforms</div>
      </div>
      <button class="modal-close" onclick="closeModal('savings')">âœ•</button>
    </div>
    <div class="form-body">
      <div class="form-group">
        <label class="form-label">Amount (GHS)</label>
        <div class="amount-input-wrap">
          <span class="currency-prefix">â‚µ</span>
          <input class="form-input" type="number" id="sav-amount" placeholder="0.00" min="0" step="0.01" inputmode="decimal">
        </div>
      </div>
      <div class="form-group">
        <label class="form-label">Platform</label>
        <select class="form-select" id="sav-platform">
          <option>Phundit</option>
          <option>Achieve</option>
          <option>Black Star App</option>
          <option>Plus App</option>
          <option>SIMS App</option>
          <option>Bamboo</option>
          <option>IC Wealth</option>
          <option>Fido Save</option>
          <option>Rise</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">Source</label>
        <select class="form-select" id="sav-source">
          <option>Salary</option>
          <option>Tips</option>
          <option>Gift</option>
          <option>Business</option>
        </select>
      </div>
      <div class="form-group">
        <label class="form-label">Date</label>
        <input class="form-input" type="date" id="sav-date">
      </div>
    </div>
    <div class="form-actions">
      <button class="btn btn-submit" onclick="submitSavings()">Submit</button>
      <button class="btn btn-reset"  onclick="resetForm('savings')">Reset</button>
      <button class="btn btn-cancel" onclick="closeModal('savings')">Cancel</button>
    </div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA STORAGE â€” localStorage for persistence
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const DB = {
  get: (k) => JSON.parse(localStorage.getItem(k) || '[]'),
  set: (k,v) => localStorage.setItem(k, JSON.stringify(v)),
};

const BUDGETS = {
  Food:500, Electricity:200, Water:80, Rent:1200,
  Health:150, Transport:200, Data:100, Clothing:150,
  Education:300, Entertainment:100,
  'Family & Social Support':200,
  'Savings/Maintenance':500, Other:100
};

const CAT_ICONS = {
  Food:'ğŸ”',Electricity:'âš¡',Water:'ğŸ’§',Rent:'ğŸ ',
  Health:'ğŸ¥',Transport:'ğŸš—',Data:'ğŸ“±',Clothing:'ğŸ‘”',
  Education:'ğŸ“š',Entertainment:'ğŸ¬',
  'Family & Social Support':'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§',
  'Savings/Maintenance':'ğŸ”§',Other:'ğŸ“¦',
  Salary:'ğŸ’¼',Tips:'ğŸ’¡',Gift:'ğŸ',Business:'ğŸ¢'
};

const PLATFORM_COLORS = {
  Phundit:'#00d4a0',Achieve:'#4facfe','Black Star App':'#ffd166',
  'Plus App':'#ff5c7c','SIMS App':'#a78bfa',Bamboo:'#34d399',
  'IC Wealth':'#fb923c','Fido Save':'#60a5fa',Rise:'#f472b6'
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let activeMonthFilter = 'All';
let monthlyChart = null;
let categoryChart = null;
let savingsChart = null;

document.addEventListener('DOMContentLoaded', () => {
  setTodayDates();
  setGreeting();
  setupMonthFilter();
  refreshAll();

  // Header date
  const now = new Date();
  document.getElementById('headerDate').innerHTML =
    now.toLocaleDateString('en-GB',{weekday:'short',day:'numeric',month:'short'}) +
    '<br>' + now.toLocaleTimeString('en-GB',{hour:'2-digit',minute:'2-digit'});
});

function setTodayDates() {
  const today = new Date().toISOString().split('T')[0];
  ['inc-date','exp-date','sav-date'].forEach(id => {
    const el = document.getElementById(id);
    if(el) el.value = today;
  });
}

function setGreeting() {
  const h = new Date().getHours();
  const day = new Date().getDay();
  const greetings = {
    0: {text:"Financial Reset Day ğŸ”„", sub:"Review your week, plan ahead"},
    1: {text:"Let's Start Strong ğŸ’¼", sub:"New week, new goals"},
    5: {text:"It's Friday! ğŸ‰", sub:"Finish the week strong"},
    6: {text:"Weekend Mode ğŸŒ…", sub:"Rest and reflect"},
  };
  const dayGreet = greetings[day] || {
    text: h<12 ? "Good Morning â˜€ï¸" : h<17 ? "Good Afternoon ğŸŒ¤ï¸" : "Good Evening ğŸŒ™",
    sub: "Track every cedis, build your wealth"
  };
  let timeLabel = h<12 ? "Morning" : h<17 ? "Afternoon" : "Evening";
  document.getElementById('greetingTime').textContent = timeLabel.toUpperCase();
  document.getElementById('greetingText').textContent = dayGreet.text;
  document.getElementById('greetingSub').textContent = dayGreet.sub;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// NAVIGATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function switchPage(pageId, navEl) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.getElementById('page-' + pageId).classList.add('active');
  if(navEl) navEl.classList.add('active');
  if(pageId === 'budget') renderBudget();
  window.scrollTo(0,0);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MONTH FILTER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function setupMonthFilter() {
  document.querySelectorAll('#monthFilter .filter-chip').forEach(chip => {
    chip.addEventListener('click', () => {
      document.querySelectorAll('#monthFilter .filter-chip').forEach(c => c.classList.remove('active'));
      chip.classList.add('active');
      activeMonthFilter = chip.dataset.month;
      refreshDashboard();
    });
  });
}

function filterByMonth(entries, month) {
  if(month === 'All') return entries;
  return entries.filter(e => {
    const d = new Date(e.date);
    return (d.getMonth()+1) === parseInt(month);
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CALCULATIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function calcTotals(month = 'All') {
  const income   = filterByMonth(DB.get('income'),   month).reduce((s,e) => s + e.amount, 0);
  const expenses = filterByMonth(DB.get('expenses'),  month).reduce((s,e) => s + e.amount, 0);
  const savings  = DB.get('savings').reduce((s,e) => s + e.amount, 0);
  return { income, expenses, net: income - expenses, savings };
}

function calcHealthScore() {
  const income   = DB.get('income').reduce((s,e)=>s+e.amount,0);
  const expenses = DB.get('expenses').reduce((s,e)=>s+e.amount,0);
  const savings  = DB.get('savings').reduce((s,e)=>s+e.amount,0);
  let score = 0;
  if(income > 0) score += Math.min(40, ((income-expenses)/income)*100*0.4);
  score += Math.min(30, (savings/10000)*30);
  const months = new Set(DB.get('income').map(e=>new Date(e.date).getMonth())).size;
  score += Math.min(30, (months/12)*30);
  return Math.round(Math.min(100, Math.max(0, score)));
}

function fmtGHS(n) {
  return 'â‚µ' + Math.abs(n).toLocaleString('en-GH',{minimumFractionDigits:2,maximumFractionDigits:2});
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// REFRESH ALL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function refreshAll() {
  refreshDashboard();
  renderIncomeList();
  renderExpenseList();
  renderSavingsList();
}

function refreshDashboard() {
  const t = calcTotals(activeMonthFilter);
  document.getElementById('kpiIncome').textContent   = fmtGHS(t.income);
  document.getElementById('kpiExpenses').textContent = fmtGHS(t.expenses);
  document.getElementById('kpiSavings').textContent  = fmtGHS(t.net);
  document.getElementById('kpiRate').textContent     = t.income > 0 ? ((t.net/t.income)*100).toFixed(1)+'%' : '0.0%';

  const savingsTotal = DB.get('savings').reduce((s,e)=>s+e.amount,0);
  const efTarget = 10000;
  document.getElementById('kpiEF').textContent     = fmtGHS(savingsTotal);
  document.getElementById('kpiEFTarget').textContent = fmtGHS(efTarget);
  document.getElementById('kpiEFPct').textContent  = Math.min(100,((savingsTotal/efTarget)*100)).toFixed(0)+'%';

  // Health score
  const score = calcHealthScore();
  document.getElementById('healthScore').textContent = score;
  const circ = 345.4;
  const offset = circ - (score/100)*circ;
  document.getElementById('healthArc').style.strokeDashoffset = offset;

  // Charts
  renderMonthlyChart();
  renderCategoryChart();
  renderSavingsChart();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CHARTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const MONTHS = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];

function renderMonthlyChart() {
  const incomeData   = Array(12).fill(0);
  const expenseData  = Array(12).fill(0);
  DB.get('income').forEach(e => { incomeData[new Date(e.date).getMonth()] += e.amount; });
  DB.get('expenses').forEach(e => { expenseData[new Date(e.date).getMonth()] += e.amount; });

  const ctx = document.getElementById('monthlyChart').getContext('2d');
  if(monthlyChart) monthlyChart.destroy();
  monthlyChart = new Chart(ctx, {
    type:'bar',
    data:{
      labels:MONTHS,
      datasets:[
        {label:'Income',data:incomeData,backgroundColor:'rgba(0,212,160,0.7)',borderRadius:6,borderSkipped:false},
        {label:'Expenses',data:expenseData,backgroundColor:'rgba(255,92,124,0.7)',borderRadius:6,borderSkipped:false}
      ]
    },
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{legend:{labels:{color:'#6b6b9a',font:{size:10}}}},
      scales:{
        x:{ticks:{color:'#6b6b9a',font:{size:9}},grid:{color:'rgba(255,255,255,0.03)'}},
        y:{ticks:{color:'#6b6b9a',font:{size:9},callback:v=>'â‚µ'+v.toLocaleString()},grid:{color:'rgba(255,255,255,0.05)'}}
      }
    }
  });
}

function renderCategoryChart() {
  const catTotals = {};
  DB.get('expenses').forEach(e => { catTotals[e.category] = (catTotals[e.category]||0)+e.amount; });
  const labels = Object.keys(catTotals);
  const values = Object.values(catTotals);
  const colors = ['#00d4a0','#ff5c7c','#ffd166','#4facfe','#a78bfa','#34d399','#fb923c','#60a5fa','#f472b6','#e879f9','#2dd4bf','#facc15','#f87171'];

  const ctx = document.getElementById('categoryChart').getContext('2d');
  if(categoryChart) categoryChart.destroy();
  if(labels.length === 0) return;
  categoryChart = new Chart(ctx, {
    type:'doughnut',
    data:{labels, datasets:[{data:values,backgroundColor:colors.slice(0,labels.length),borderWidth:0,hoverOffset:6}]},
    options:{
      responsive:true, maintainAspectRatio:false,
      plugins:{legend:{position:'right',labels:{color:'#6b6b9a',font:{size:9},boxWidth:10,padding:8}}}
    }
  });
}

function renderSavingsChart() {
  const platTotals = {};
  DB.get('savings').forEach(e => { platTotals[e.platform] = (platTotals[e.platform]||0)+e.amount; });
  const labels = Object.keys(platTotals);
  const values = Object.values(platTotals);
  const colors = labels.map(l => PLATFORM_COLORS[l] || '#6b6b9a');

  const ctx = document.getElementById('savingsChart').getContext('2d');
  if(savingsChart) savingsChart.destroy();
  if(labels.length === 0) return;
  savingsChart = new Chart(ctx, {
    type:'doughnut',
    data:{labels,datasets:[{data:values,backgroundColor:colors,borderWidth:0,hoverOffset:6}]},
    options:{
      responsive:true,maintainAspectRatio:false,
      plugins:{legend:{position:'right',labels:{color:'#6b6b9a',font:{size:9},boxWidth:10,padding:8}}}
    }
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDER LISTS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderIncomeList() {
  const raw  = DB.get('income');
  const data = raw.slice().reverse();
  const el   = document.getElementById('incomeList');
  if(data.length === 0) {
    el.innerHTML = `<div class="empty-state"><div class="empty-icon">ğŸ’µ</div><p>No income entries yet.<br>Tap Add Income to get started.</p></div>`;
    return;
  }
  el.innerHTML = data.map((e, i) => {
    const realIdx = raw.length - 1 - i;
    return `
    <div class="log-item">
      <div class="log-item-left">
        <div class="log-item-icon" style="background:rgba(0,212,160,0.1)">${CAT_ICONS[e.type]||'ğŸ’µ'}</div>
        <div>
          <div class="log-item-title">${e.type}</div>
          <div class="log-item-sub">${e.description || 'â€”'}</div>
        </div>
      </div>
      <div>
        <div class="log-item-amount" style="color:var(--emerald)">+${fmtGHS(e.amount)}</div>
        <div class="log-item-date">${formatDate(e.date)}</div>
        <button onclick="confirmDelete('income',${realIdx})" style="background:none;border:none;color:var(--red);font-size:11px;cursor:pointer;margin-top:4px;padding:4px 0;">ğŸ—‘ delete</button>
      </div>
    </div>`;
  }).join('');
}

function renderExpenseList() {
  const raw  = DB.get('expenses');
  const data = raw.slice().reverse();
  const el   = document.getElementById('expenseList');
  if(data.length === 0) {
    el.innerHTML = `<div class="empty-state"><div class="empty-icon">ğŸ’¸</div><p>No expenses yet.<br>Tap Add Expense to get started.</p></div>`;
    return;
  }
  el.innerHTML = data.map((e, i) => {
    const realIdx = raw.length - 1 - i;
    return `
    <div class="log-item">
      <div class="log-item-left">
        <div class="log-item-icon" style="background:rgba(255,92,124,0.1)">${CAT_ICONS[e.category]||'ğŸ“¦'}</div>
        <div>
          <div class="log-item-title">${e.category}</div>
          <div class="log-item-sub">${e.description || 'â€”'}</div>
        </div>
      </div>
      <div>
        <div class="log-item-amount" style="color:var(--red)">-${fmtGHS(e.amount)}</div>
        <div class="log-item-date">${formatDate(e.date)}</div>
        <span class="log-item-status ${e.status==='Overspent'?'status-bad':'status-ok'}">${e.status}</span>
        <br><button onclick="confirmDelete('expenses',${realIdx})" style="background:none;border:none;color:var(--red);font-size:11px;cursor:pointer;margin-top:4px;padding:4px 0;">ğŸ—‘ delete</button>
      </div>
    </div>`;
  }).join('');
}

function renderSavingsList() {
  const raw   = DB.get('savings');
  const data  = raw.slice().reverse();
  const total = raw.reduce((s,e)=>s+e.amount,0);
  document.getElementById('totalSavingsDisplay').textContent = fmtGHS(total);

  const el = document.getElementById('savingsList');
  if(data.length === 0) {
    el.innerHTML = `<div class="empty-state"><div class="empty-icon">ğŸ’°</div><p>No savings logged yet.<br>Tap Add Savings to get started.</p></div>`;
    return;
  }
  el.innerHTML = data.map((e, i) => {
    const realIdx = raw.length - 1 - i;
    return `
    <div class="log-item">
      <div class="log-item-left">
        <div class="log-item-icon" style="background:rgba(0,212,160,0.1)">ğŸ¦</div>
        <div>
          <div class="log-item-title">${e.platform}</div>
          <div class="log-item-sub">${e.source}</div>
        </div>
      </div>
      <div>
        <div class="log-item-amount" style="color:var(--blue)">+${fmtGHS(e.amount)}</div>
        <div class="log-item-date">${formatDate(e.date)}</div>
        <button onclick="confirmDelete('savings',${realIdx})" style="background:none;border:none;color:var(--red);font-size:11px;cursor:pointer;margin-top:4px;padding:4px 0;">ğŸ—‘ delete</button>
      </div>
    </div>`;
  }).join('');
  renderSavingsChart();
}

function renderBudget() {
  const expenses = DB.get('expenses');
  const now = new Date();
  const thisMonth = expenses.filter(e => {
    const d = new Date(e.date);
    return d.getMonth()===now.getMonth() && d.getFullYear()===now.getFullYear();
  });

  let html = '';
  Object.entries(BUDGETS).forEach(([cat, budget]) => {
    const spent = thisMonth.filter(e=>e.category===cat).reduce((s,e)=>s+e.amount,0);
    const pct = Math.min(100,(spent/budget)*100);
    const over = spent > budget;
    html += `
      <div class="budget-item">
        <div class="budget-top">
          <div class="budget-cat">${CAT_ICONS[cat]||'ğŸ“¦'} ${cat}</div>
          <div class="log-item-status ${over?'status-bad':'status-ok'}">${over?'Overspent':'On Track'}</div>
        </div>
        <div class="budget-bar-track">
          <div class="budget-bar-fill ${over?'bad':'ok'}" style="width:${pct}%"></div>
        </div>
        <div class="budget-bottom">
          <div class="budget-amounts" style="color:var(--muted);font-size:11px">${fmtGHS(spent)} spent</div>
          <div class="budget-pct" style="color:${over?'var(--red)':'var(--emerald)'}">${pct.toFixed(0)}% of ${fmtGHS(budget)}</div>
        </div>
      </div>`;
  });
  document.getElementById('budgetList').innerHTML = html;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SUBMIT HANDLERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function submitIncome() {
  const amount = parseFloat(document.getElementById('inc-amount').value);
  const type   = document.getElementById('inc-type').value;
  const desc   = document.getElementById('inc-desc').value;
  const date   = document.getElementById('inc-date').value;

  if(!amount || amount <= 0) { showToast('Enter a valid amount', true); return; }
  if(!date) { showToast('Select a date', true); return; }

  const data = DB.get('income');
  data.push({ amount, type, description:desc, date, id:Date.now() });
  DB.set('income', data);

  closeModal('income');
  showToast('Income added! â‚µ'+amount.toFixed(2));
  refreshAll();
}

function submitExpense() {
  const amount   = parseFloat(document.getElementById('exp-amount').value);
  const category = document.getElementById('exp-cat').value;
  const desc     = document.getElementById('exp-desc').value;
  const date     = document.getElementById('exp-date').value;

  if(!amount || amount <= 0) { showToast('Enter a valid amount', true); return; }
  if(!date) { showToast('Select a date', true); return; }

  // Budget check
  const expenses = DB.get('expenses');
  const d = new Date(date);
  const monthSpent = expenses.filter(e => {
    const ed = new Date(e.date);
    return e.category===category && ed.getMonth()===d.getMonth() && ed.getFullYear()===d.getFullYear();
  }).reduce((s,e)=>s+e.amount,0);
  const budget = BUDGETS[category] || 0;
  const status = budget > 0 && (monthSpent + amount) > budget ? 'Overspent' : 'On Track';

  expenses.push({ amount, category, description:desc, date, status, id:Date.now() });
  DB.set('expenses', expenses);

  closeModal('expense');
  if(status === 'Overspent') {
    showToast('âš ï¸ Budget exceeded for '+category+'!', true);
  } else {
    showToast('Expense recorded! â‚µ'+amount.toFixed(2));
  }
  refreshAll();
}

function submitSavings() {
  const amount   = parseFloat(document.getElementById('sav-amount').value);
  const platform = document.getElementById('sav-platform').value;
  const source   = document.getElementById('sav-source').value;
  const date     = document.getElementById('sav-date').value;

  if(!amount || amount <= 0) { showToast('Enter a valid amount', true); return; }
  if(!date) { showToast('Select a date', true); return; }

  const data = DB.get('savings');
  data.push({ amount, platform, source, date, id:Date.now() });
  DB.set('savings', data);

  closeModal('savings');
  showToast('Savings logged! â‚µ'+amount.toFixed(2));
  refreshAll();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// CUSTOM CONFIRM DIALOG (replaces browser confirm())
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let _confirmCallback = null;

function showConfirm(title, msg, icon, yesLabel, callback) {
  document.getElementById('confirmTitle').textContent = title;
  document.getElementById('confirmMsg').textContent   = msg;
  document.getElementById('confirmIcon').textContent  = icon || 'âš ï¸';
  document.getElementById('confirmYesBtn').textContent = yesLabel || 'Yes';
  _confirmCallback = callback;
  const overlay = document.getElementById('confirmOverlay');
  overlay.style.display = 'flex';
}
function handleConfirmYes() {
  document.getElementById('confirmOverlay').style.display = 'none';
  if(_confirmCallback) { _confirmCallback(); _confirmCallback = null; }
}
function handleConfirmNo() {
  document.getElementById('confirmOverlay').style.display = 'none';
  _confirmCallback = null;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DELETE ENTRY
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function confirmDelete(store, index) {
  showConfirm(
    'Delete Entry?',
    'This entry will be permanently removed.',
    'ğŸ—‘ï¸', 'Delete',
    () => {
      const data = DB.get(store);
      data.splice(index, 1);
      DB.set(store, data);
      refreshAll();
      showToast('Entry deleted');
    }
  );
}

function deleteEntry(store, id) {
  confirmDelete(store, id);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MODAL HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openModal(type) {
  document.getElementById('modal-'+type).classList.add('open');
  document.body.style.overflow = 'hidden';
}
function closeModal(type) {
  document.getElementById('modal-'+type).classList.remove('open');
  document.body.style.overflow = '';
}
function resetForm(type) {
  showConfirm('Clear Form?', 'All fields will be reset to empty.', 'ğŸ”„', 'Clear', () => {
    const today = new Date().toISOString().split('T')[0];
    if(type==='income') {
      document.getElementById('inc-amount').value='';
      document.getElementById('inc-desc').value='';
      document.getElementById('inc-date').value=today;
      document.getElementById('inc-type').selectedIndex=0;
      document.getElementById('inc-amount').focus();
    } else if(type==='expense') {
      document.getElementById('exp-amount').value='';
      document.getElementById('exp-desc').value='';
      document.getElementById('exp-date').value=today;
      document.getElementById('exp-cat').selectedIndex=0;
      document.getElementById('exp-amount').focus();
    } else if(type==='savings') {
      document.getElementById('sav-amount').value='';
      document.getElementById('sav-date').value=today;
      document.getElementById('sav-platform').selectedIndex=0;
      document.getElementById('sav-source').selectedIndex=0;
      document.getElementById('sav-amount').focus();
    }
    showToast('Form cleared');
  });
}

// Close modal when clicking overlay background
document.querySelectorAll('.modal-overlay').forEach(overlay => {
  overlay.addEventListener('click', e => {
    if(e.target === overlay) {
      const type = overlay.id.replace('modal-','');
      closeModal(type);
    }
  });
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TOAST NOTIFICATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showToast(msg, isError=false) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.className = 'toast' + (isError?' error':'');
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 3000);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UTILS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function formatDate(dateStr) {
  const d = new Date(dateStr);
  return d.toLocaleDateString('en-GB',{day:'2-digit',month:'short',year:'numeric'});
}
</script>
</body>
</html>
